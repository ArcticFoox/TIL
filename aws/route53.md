# Route 53

클라우드 DNS 웹서비스

도메인 구입부터 네임서버 등록까지 DNS에 필요한 모든 기능 제공

추가적으로 모니터링 기능 제공

등록 외에 부가적인 기능 제공 및 안정성, GUI를 제공해 관리가 수월

사용자의 요청을 EC2, Ealstic Load Balancing 로드 밸런서, S3 버킷 등 AWS에서 실행되는,

인파라에 효과적으로 연결하고 AWS 외부의 인프라로 라우팅하는데에도 사용 됨

# 전체적인 동작 원리

![image.png](/aws/img/image.png)

1. 사용자가 브라우저에 도메인 입력 시 DNS 리졸버(보통 인터넷 제공업체의 DNS 서버)가 해당 도메인의 IP 주소를 찾기 위한 질의 시작
2. 가장 먼저 DNS 루트 네임서버 접속 .com과 같은 최상위 도메인(TLD, Top Level Domain)을 담당하는 TLD 네입서버의 위치 파악
    1. DNS 루트 네임서버 : 전 세계에 13개 루트 서버 존재, 최상위 DNS 질의 처리
    2. TLD 네임서버 : .com, .net, .org 등 TLD별로 존재
3. example.com 도메인의 네임서버로 등록된 Route 53 네임서버에 질의 전달
4. Route 53은 A 레코드 등을 기반으로 해당 IP 주소를 응답
5. 사용자의 브라우저는 응답밥은 IP 주소로 웹 서버에 접속

# 사용법

## 호스팅 영역 생성

호스팅 영역이란 레코드의 컨테이너이며, 

레코드에는 특정 도메인과 하위 도메인의 트래픽을 라우팅하는 방식에 대한 레코드들의 정보 집합체

### 호스팅 유형

퍼블릭 호스팅 영역

인터넷에서 트래픽을 라우팅하고자 하는 방법을 지정하는 레코드를 포함

→ 브라우저에 도메인으로 접속해서 사용하는 일반적인 도메인

프라이빗 호스팅 역영

Amazon VPC에서 트래픽을 라우팅하고자 하는 방법을 지정하는 레코드를 포함

Route 53을 이용하여 지정한 VPC에서 요청한 DNS 쿼리 응답을 반환하는 일종의 컨테이너

→ VPC 내 AWS 서비스들의 사설 IP대신 도메인으로 이용하고자 할때 사용하는 영역

![image.png](/aws/img/image1.png)

## NameServer 등록

생성된 호스팅 영역에는 NS와 SOA가 자동으로 생성

NS

네임서버 레코드로 도메인에 대한 네임서버의 권한을 가지고 있는지 알려주는 레코드

ex) naver.com의 NS레코드는 e-ns.naver.com, ns1.naver.com, ns2.naver.com

SOA

도메인의 정보를 가지고 있는 레코드

naver의 경우 [ns1.naver.com](http://ns1.naver.com) [webmaster.naver.com](http://webmaster.naver.com) 2021012809 21600 1800 1209600 180 인데,

각각 마스터 네임서버, 존 관리자 연락처, 존 데이터 동기화 시간, 갱신주기, 시도, 만료 등 정보

등록을 위해서 NS에 해당하는 도메인의 Value 값 4개를 구입한 도메인 설정에 적어야한다.

## Route 53 ↔ EC2 도메인 연결

### 설정해야 하는 값

레코드 이름 : 라우팅할 이름 지정

레코드 유형 : DNS 레코드를 선택하는 항목. EC2로 라우팅 시 IPv4로 라우팅하기에 기본값 사용

값 : 라우팅 할 EC2의 IPv4를 입력

TTL : DNS에 IP주소를 저장할 시간, health check 기능을 사용할 경우 AWS에서 60초 이하 권장

라우팅 정책 : 트래픽에 대한 라우팅방법 선택

- 단순 - 표준 DNS기능 사용
- 가중치 기반 - 각 리소스에 보낼 트래픽을 지정 가능
- 지리적 위치 - 지정한 위치의 가까운 사용자의 트래픽을 라우팅
- 지연 시간 - 지연시간이 가장 짧은 리전으로 트래픽을 라우팅
- 장애 조치 - 정상 상태일때만 트래픽을 라우팅
- 다중값 응답 - DNS의 look up 시 IP값을 다중으로 반환하도록 구성

출처

https://inpa.tistory.com/entry/AWS-%F0%9F%93%9A-Route-53-%EA%B0%9C%EB%85%90-%EC%9B%90%EB%A6%AC-%EC%82%AC%EC%9A%A9-%EC%84%B8%ED%8C%85-%F0%9F%92%AF-%EC%A0%95%EB%A6%AC

https://sjh9708.tistory.com/279