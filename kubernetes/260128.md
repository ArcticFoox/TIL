# 배운 내용
## 핵심 용어
Pod: 쿠버네티스에서 가장 작은 배포 단위로, 하나 이상의 컨테이너를 포함할 수 있음  
-> 하나의 pod 내에서 여러 컨테이너를 실행할 경우, 컨테이너에서 문제가 발생 시 어떤 컨테이너인지 식별하기 어렵고 디버깅이 복잡해질 수 있음  
-> 일반적으로 하나의 pod에는 하나의 컨테이너를 배포하는 것이 권장됨  
Node: 쿠버네티스 클러스터 내에서 워크로드를 실행하는 물리적 또는 가상 머신  
Deployment: 애플리케이션의 배포 및 관리를 자동화하는 쿠버네티스 리소스  
Service: 쿠버네티스 내에서 네트워크 서비스를 정의하고, Pod 간의 통신을 가능하게 하는 리소스  
Namespace: 쿠버네티스 클러스터 내에서 리소스를 논리적으로 구분하는 단위  

## yaml 파일 구성

Deployment
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: frontend
  labels:
    app: frontend
spec:
  replicas: 3
  selector:
    matchLabels:
      app: frontend
  template:
    metadata:
      labels:
        app: frontend
    spec:
      containers:
        - name: frontend
          image: imagename
          imagePullPolicy: IfNotPresent
          ports:
            - name: http
              containerPort: 8081
          env:
            - name: SPRING_PROFILES_ACTIVE
              value: "dev"
```
- metadata: Deployment의 이름과 라벨 설정
- spec: 배포 사양 정의
  - replicas: 생성할 Pod의 개수 지정
  - selector: 어떤 Pod를 관리할지 선택하는 기준
  - template: 생성될 Pod의 템플릿 정의
    - metadata: Pod의 라벨 설정
    - spec: Pod 내 컨테이너 사양 정의
      - containers: 컨테이너 목록 및 설정
        - name: 컨테이너 이름
        - image: 사용할 도커 이미지
        - imagePullPolicy: 이미지 풀 정책 설정
        - ports: 컨테이너가 노출할 포트 설정
        - env: 환경 변수 설정

Service
```yaml
apiVersion: v1
kind: Service
metadata:
  name: frontend-service  # 서비스의 이름
spec:
  type: LoadBalancer      # 서비스 타입 설정
  selector:
    app: frontend         # Deployment의 labels와 일치해야 함
  ports:
    - name: http
      protocol: TCP
      port: 80            # 서비스가 외부에서 받을 포트
      targetPort: 8081    # 컨테이너 내부(Deployment) 포트
```
- metadata: Service의 이름 설정
- spec: 서비스 사양 정의
  - type: 서비스 타입 설정 (예: LoadBalancer, NodePort, ClusterIP)
    - selector: 어떤 Pod에 트래픽을 라우팅할지 선택하는 기준
    - ports: 서비스가 노출할 포트 설정
      - name: 포트 이름
      - protocol: 프로토콜 설정 (예: TCP, UDP)
      - port: 외부에서 접근할 포트
      - targetPort: 내부 컨테이너 포트

targetPort는 Deployment의 컨테이너 포트와 일치해야 함  
-> 변경이 잦은 경우, targetPort에 변수를 사용하여 관리하는 것이 좋음  
-> 예: targetPort: front (Deployment에서 containerPort: front로 설정)

### FQDN(Fully Qualified Domain Name)
- 도메인의 전체 경로를 나타내는 이름
- 쿠버네티스 클러스터 내부에서 사용하는 서비스의 FQDN 형식: <서비스 이름>.<네임스페이스>.svc.cluster.local

|항목|예시값| 의미                      |  
|-----|-----|---------------------|  
|Service Name|	backend-service | 	접속하려는 서비스의 이름             |
|Namespace	|default	| 서비스가 생성된 네임스페이스 (별도 설정 없으면 default) |
|Resource Type|	svc	| 이 리소스가 Service임을 나타냄                |
|Cluster Domain|	cluster.local	| 쿠버네티스 클러스터의 기본 도메인 접미사       |

